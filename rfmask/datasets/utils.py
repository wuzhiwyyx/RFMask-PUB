'''
 # @ Author: Zhi Wu
 # @ Create Time: 1970-01-01 00:00:00
 # @ Modified by: Zhi Wu
 # @ Modified time: 2022-08-27 15:52:34
 # @ Description: Dataset loader.
 '''

from torch.utils.data import DataLoader

from .hiber_dataset import HIBERDataset, HiberTrans, hiber_collate
from .rf_dataset import RFDataset, RFTrans, rf_collate

def load_rf_dataset(config):
    """Load rf dataset from file

    Args:
        config (dict): Dict object containing dataset initial parameters and dataloader initial parameters.

    Returns:
        (Dataset, DataLoader): _description_
    """
    dataset = RFDataset(**config.dataset, transform=RFTrans())
    loader = DataLoader(dataset, **config.loader, drop_last=True, collate_fn=rf_collate)
    return dataset, loader

def load_hiber_dataset(config):
    dataset = HIBERDataset(**config.dataset, transform=HiberTrans())
    loader = DataLoader(dataset, **config.loader, drop_last=True, collate_fn=hiber_collate)
    return dataset, loader


camera_parameter = {
    'view01' : {
        'D': [0.0, 0.0, 0.0, 0.0, 0.0],
        'K': [[1305.8325745011168, -2.2737367544323206e-13, 843.6312335076423],
            [0.0, 1293.9228696957473, 641.6248152978053],
            [0.0, 0.0, 0.9999999999999999]],
        'M': [[1549.3949915791495, -124.67316329844094, 27.278804967383287, 5335.204495264358],
            [411.0924766281656, 483.3246097214964, -1297.4278760782445, 1045.9272522936803],
            [0.6084533963825272, 0.7935659849936614, -0.006123062273634765, 1.346545884678695]],
        'P': [[1305.8325745011168, -2.2737367544323206e-13, 843.6312335076423, 0.0],
            [0.0, 1293.9228696957473, 641.6248152978053, 0.0],
            [0.0, 0.0, 0.9999999999999999, 0.0]],
        'mask_box': [476, 263, 641, 597],
        'offset': [165.0, 132.0, 97.0, 112.0, 85.962607991656, 128.65236639085722],
        'r_mat': [[0.793580861556921, 0.6084648027376565, 0.0],
                [-0.6084648027376565, 0.793580861556921, 0.0],
                [0.0, 0.0, 1.0]]},
    'view02' : {
        'D': [0.0, 0.0, 0.0, 0.0, 0.0],
        'K': [[1356.144916818313, -0.0, 914.6437955025881],
            [-0.0, 1333.8589305189234, 596.3537667477827],
            [-0.0, -0.0, 1.0]],
        'M': [[1624.8196327735739, 152.40020855739533,
                111.52419221290313, 3402.7477766352213],
            [368.0599230817294, 593.9928468836958, -1283.1686765626055, 607.4248873153989],
            [0.475416815954178, 0.8763588087450481, 0.07729223404036964, 0.6364638100624557]],
        'P': [[1356.144916818313, -0.0, 914.6437955025881, 0.0],
            [-0.0, 1333.8589305189234, 596.3537667477827, 0.0],
            [-0.0, -0.0, 1.0, 0.0]],
        'mask_box': [51, 275, 222, 575],
        'offset': [160.0, 150.0, 99.0, 126.0, 87.03049827970727, 130.54338757157265],
        'r_mat': [[0.878988319280169, 0.4768433019022326, 3.1082247233191917e-16],
                [-0.4768433019022326, 0.878988319280169, 3.3660924650306697e-16],
                [-1.1269945799619547e-16, -4.440892098500626e-16, 1.0]]},
    'view03' : {
        'D': [0.16781143240662685, -0.2482187345964878, -0.0003372502121982848, 0.004506727231028916, 0.0],
        'K': [[1314.1288111891804, 2.2737367544323206e-13, 835.9606626959608],
            [0.0, 1302.4772189011971, 641.3630800509387],
            [0.0, 0.0, 0.9999999999999999]],
        'M': [[1430.3457165293505, -616.261822819561, 9.861993399385733, 6539.364000134802],
            [516.2248897884897, 306.9970044354003, -1321.763295238439, 1228.762728508339],
            [0.826694181202381, 0.561747178079372, -0.0318879081469304, 1.6155233693250532]],
        'P': [[1314.1288111891804, 2.2737367544323206e-13, 835.9606626959608, 0.0],
            [0.0, 1302.4772189011971, 641.3630800509387, 0.0],
            [0.0, 0.0, 0.9999999999999999, 0.0]],
        'mask_box': [657, 258, 840, 611],
        'offset': [184.0, 127.0, 99.0, 108.0, 87.239428234093, 130.04733901788293],
        'r_mat': [[0.562032999204545, 0.8271148093252495, 0.0],
                [-0.8271148093252495, 0.562032999204545, 0.0],
                [0.0, 0.0, 1.0]]},
    'view04' : {
        'D': [0.07298510403288225, -0.1820750179609321, 0.006002492562493937, -0.011042761826668865, 0.0],
        'K': [[1274.0202807348267, -0.0, 837.4036314868099],
            [-0.0, 1268.6697303109606, 667.6032570077422],
            [-0.0, -0.0, 1.0000000000000004]],
        'M': [[932.9823581873092, -1205.0228969766702, -42.85154401121399, 7787.466978239955],
            [658.7121904763786, 91.23185471894396, -1270.036216876111, 2483.9690072974345],
            [0.9970176783095874, 0.07711485767530138, -0.0030079667350371166, 3.651061407824546]],
        'P': [[1274.0202807348267, -0.0, 837.4036314868099, 0.0],
            [-0.0, 1268.6697303109606, 667.6032570077422, 0.0],
            [-0.0, -0.0, 1.0000000000000004, 0.0]],
        'mask_box': [-98, 272, 135, 739],
        'offset': [181.0, 86.0, 101.0, 109.0, 89.07471981396108, 132.01427988352842],
        'r_mat': [[0.077115206540049, 0.9970221887803128, 0.0],
                [-0.9970221887803128, 0.077115206540049, 0.0],
                [0.0, 0.0, 1.0]]},
    'view05' : {
        'D': [0.0, 0.0, 0.0, 0.0, 0.0],
        'K': [[1304.7509689286944, 2.2737367544323206e-13, 835.2964875960149],
            [0.0, 1291.1214654345536, 637.3083587153753],
            [0.0, 0.0, 1.0]],
        'M': [[582.766150681678, -1434.801519347305, 42.70277284827788, 8904.126801284365],
            [674.7930440227042, -134.58655277106394, -1264.791441363409, 3536.7494425309783],
            [0.9825118295998494, -0.1819262241909736, 0.03966552215680852, 4.793393867203525]],
        'P': [[1304.7509689286944, 2.2737367544323206e-13, 835.2964875960149, 0.0],
            [0.0, 1291.1214654345536, 637.3083587153753, 0.0],
            [0.0, 0.0, 1.0, 0.0]],
        'mask_box': [49, 297, 207, 624],
        'offset': [182.0, 64.0, 98.0, 116.0, 87.02056155767006, 129.54140573064072],
        'r_mat': [[-0.18206951043736685, 0.9832856621394911, 0.0],
                [-0.9832856621394911, -0.18206951043736685, 0.0],
                [0.0, 0.0, 1.0]]},
    'view06' : {
        'D': [0.0, 0.0, 0.0, 0.0, 0.0],
        'K': [[1293.6482898147763, -0.0, 808.5518889182525],
            [-0.0, 1293.707896220071, 645.4349654816391],
            [-0.0, -0.0, 1.0]],
        'M': [[210.89890649119909, -1510.7335660158535, -22.086162360402426, 9293.73968079494],
            [557.1625771240057, -248.4972109852065, -1310.7575726249145, 3834.6536720824415],
            [0.9128582834940339, -0.40737251115313033, -0.027154951907876645, 5.9360959931601665]],
        'P': [[1293.6482898147763, -0.0, 808.5518889182525, 0.0],
            [-0.0, 1293.707896220071, 645.4349654816391, 0.0],
            [-0.0, -0.0, 1.0, 0.0]],
        'mask_box': [589, 263, 764, 561],
        'offset': [179.0, 41.0, 97.0, 117.0, 85.81242169022669, 128.33727127364875],
        'r_mat': [[-0.40752279076525255, 0.9131950366744775, 0.0],
                [-0.9131950366744775, -0.40752279076525255, 0.0],
                [0.0, 0.0, 1.0]]},
    'view07' : {
        'D': [0.0, 0.0, 0.0, 0.0, 0.0],
        'K': [[1305.351148472436, -0.0, 836.0146113946103],
            [-0.0, 1295.2384296381813, 640.5301220702602],
            [-0.0, -0.0, 1.0]],
        'M': [[-243.10791248376356, -1530.7371912776343, -24.581403760471662, 9558.654572598654],
            [426.51121540486184, -396.32704836445913, -1322.4728657932865, 4490.587344058653],
            [0.7464179804800766, -0.66397920797698, -0.0446296962829319, 7.302471637844017]],
        'P': [[1305.351148472436, -0.0, 836.0146113946103, 0.0],
            [-0.0, 1295.2384296381813, 640.5301220702602, 0.0],
            [-0.0, -0.0, 1.0, 0.0]],
        'mask_box': [593, 252, 804, 620],
        'offset': [159.0, 14.0, 96.0, 118.0, 84.76901340010026, 127.26274966846132],
        'r_mat': [[-0.6646414575913149, 0.7471624541228583, 0.0],
                [-0.7471624541228583, -0.6646414575913149, 0.0],
                [0.0, 0.0, 1.0]]},
    'view8' : {
        'D': [0.0, 0.0, 0.0, 0.0, 0.0],
        'K': [[1314.089900087793, -0.0, 820.1623954016396],
            [-0.0, 1300.4641154673693, 643.4097021333675],
            [-0.0, -0.0, 1.0]],
        'M': [[-545.5900051456138, -1449.3246031752155, -35.89374959397228, 9708.798343152339],
            [348.33314242833177, -462.2787981024459, -1330.4680736976134, 5026.524988304109],
            [0.6070050899465098, -0.7931809398674916, -0.04907970466447775, 8.263734362860168]],
        'P': [[1314.089900087793, -0.0, 820.1623954016396, 0.0],
            [-0.0, 1300.4641154673693, 643.4097021333675, 0.0],
            [-0.0, -0.0, 1.0, 0.0]],
        'mask_box': [578, 255, 764, 547],
        'offset': [153.0, -4.0, 97.0, 121.0, 85.60734744964599, 128.28843117336663],
        'r_mat': [[-0.7941379832506503, 0.607737495600354, 0.0],
                [-0.607737495600354, -0.7941379832506503, 0.0],
                [0.0, 0.0, 1.0]]},
    'view09' : {
        'D': [0.15918242444599046, -0.27092723002379093, 0.0009636424946346013, 0.0021122780543035686, 0.0],
        'K': [[1304.1753744543848, 2.2737367544323206e-13, 828.3382500709317],
            [-0.0, 1290.2571376550668, 649.0123956658495],
            [-0.0, -0.0, 1.0000000000000002]],
        'M': [[-845.7285019140804, -1292.5311386118865, -33.529399526910574, 9011.263136224268],
            [232.74746574568772, -533.936306820532, -1321.6358077948641, 5088.131390045665],
            [0.41257262325491195, -0.9094971865647938, -0.050977428056796406, 8.502627825276658]],
        'P': [[1304.1753744543848, 2.2737367544323206e-13, 828.3382500709317, 0.0],
            [-0.0, 1290.2571376550668, 649.0123956658495, 0.0],
            [-0.0, -0.0, 1.0000000000000002, 0.0]],
        'mask_box': [238, 245, 348, 509],
        'offset': [141.0, -13.0, 93.0, 112.0, 82.35662921793529, 124.60581533177356],
        'r_mat': [[-0.9106812491689573, 0.4131097462080355, 0.0],
                [-0.4131097462080355, -0.9106812491689573, 0.0],
                [0.0, 0.0, 1.0]]},
    'view10' : {
        'D': [0.0, 0.0, 0.0, 0.0, 0.0],
        'K': [[1321.1012066760857, 0.0, 841.5706571509673],
            [0.0, 1308.3723484596323, 638.4018575120938],
            [0.0, 0.0, 1.0]],
        'M': [[-1222.9210050337542, -978.6817490512065, 13.99352635418638, 6516.742567221791],
            [61.78161179475071, -644.8046898324886, -1303.7657298390448, 5469.265858424439],
            [0.10753795389950671, -0.9941754395669903, 0.007126277632059974, 8.195397972700729]],
        'P': [[1321.1012066760857, 0.0, 841.5706571509673, 0.0],
            [0.0, 1308.3723484596323, 638.4018575120938, 0.0],
            [0.0, 0.0, 1.0, 0.0]],
        'mask_box': [33, 280, 208, 599],
        'offset': [100.0, -2.0, 98.0, 113.0, 86.22785784604694, 129.45325811465625],
        'r_mat': [[-0.994200684548215, 0.10754068459825493, 0.0],
                [-0.10754068459825493, -0.994200684548215, 0.0],
                [0.0, 0.0, 1.0]]}
}